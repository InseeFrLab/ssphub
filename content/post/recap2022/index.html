<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.91">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-12-31">

<title>L’année 2022 dans le monde de la data science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script type="module" src="index_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="index_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dynamique-du-réseau" id="toc-dynamique-du-réseau" class="nav-link active" data-scroll-target="#dynamique-du-réseau">Dynamique du réseau</a></li>
  <li><a href="#evolution-composition-réseau" id="toc-evolution-composition-réseau" class="nav-link" data-scroll-target="#evolution-composition-réseau">Evolution composition réseau</a></li>
  <li><a href="#répartition-des-modes-daccès-au-réseau" id="toc-répartition-des-modes-daccès-au-réseau" class="nav-link" data-scroll-target="#répartition-des-modes-daccès-au-réseau">Répartition des modes d’accès au réseau</a></li>
  <li><a href="#composition-du-réseau" id="toc-composition-du-réseau" class="nav-link" data-scroll-target="#composition-du-réseau">Composition du réseau</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">L’année 2022 dans le monde de la data science</h1>
<p class="subtitle lead">Rétrospective d’une année riche</p>
  <div class="quarto-categories">
    <div class="quarto-category">Insee</div>
    <div class="quarto-category">Retrospective</div>
    <div class="quarto-category">Infolettre</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>linogaliana </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 31, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><em>Vous désirez intégrer la liste de diffusion ? Un mail à <a href="mailto:ssphub-contact@insee.fr" class="email">ssphub-contact@insee.fr</a> suffit</em></p>
<p>La <a href="https://ssphub.netlify.app/post/retrospective2022/">rétrospective de l’année 2022</a> promettait une version plus personnalisée, inspirée des visualisations proposées par plusieurs applications pour synthétiser l’activité de leurs utilisateurs.</p>
<p>Cette <em>newsletter</em> permet aussi d’illustrer le potentiel d’outils qui ont été présentés dans la <a href="https://ssphub.netlify.app/post/retrospective2022/">rétrospective de l’année 2022</a>. Les principaux ingrédients ici utilisés sont <code>Observable</code>, <code>Quarto</code> et <code>DuckDB</code>. Les données sont stockées sur le système de stockage <code>S3</code> du <code>SSPCloud</code>.</p>
<section id="dynamique-du-réseau" class="level2">
<h2 class="anchored" data-anchor-id="dynamique-du-réseau">Dynamique du réseau</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="71" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 70;"><span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>parseDate <span class="op">=</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)<span class="op">;</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>startDate <span class="op">=</span> <span class="fu">parseDate</span>(<span class="st">"2022-06-30"</span>)<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>endDate <span class="op">=</span> <span class="fu">parseDate</span>(<span class="st">"2022-09-05"</span>)<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>daysBetween <span class="op">=</span> d3<span class="op">.</span><span class="at">utcDay</span><span class="op">.</span><span class="fu">count</span>(startDate<span class="op">,</span> endDate)<span class="op">;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>middleDate <span class="op">=</span> d3<span class="op">.</span><span class="at">utcDay</span><span class="op">.</span><span class="fu">offset</span>(startDate<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(daysBetween <span class="op">/</span> <span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co">// Line for network</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="fu">addTooltips</span>(</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ Nombre d'inscrits à la liste de diffusion"</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(serie_contacts<span class="op">,</span> {</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#6886bb"</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="co">//marker: "circle",</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span>        </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(serie_contacts<span class="op">,</span> {</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>              })<span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> </span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> inscrits `</span><span class="op">,</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#6886bb"</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">//marker: "circle",</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">// vertical rule to mark date/time of event</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-06-30"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-09-05"</span>)]<span class="op">,</span> {</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4 2"</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([[<span class="dv">0</span>]]<span class="op">,</span> {</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"Réseau en pause pendant </span><span class="sc">\n</span><span class="st"> les vacances d'été 🌞"</span>]<span class="op">,</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> middleDate<span class="op">,</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> <span class="dv">290</span><span class="op">,</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>      <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"center"</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>      <span class="co">//fill: "#6886bb"</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">500</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">text</span>(annotations<span class="op">,</span> {</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>          <span class="dt">lineHeight</span><span class="op">:</span> <span class="fl">1.3</span><span class="op">,</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>          <span class="dt">width</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>            <span class="vs">`</span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>                <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>              })<span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> </span><span class="sc">${</span>d<span class="op">.</span><span class="at">text</span><span class="sc">}</span><span class="vs"> `</span><span class="op">,</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> [</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>(annotations<span class="op">,</span> {</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>            <span class="dt">lineHeight</span><span class="op">:</span> <span class="fl">1.3</span><span class="op">,</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"#6886bb"</span><span class="op">,</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>            <span class="dt">text</span><span class="op">:</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>            <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"center"</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>          })<span class="op">,</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">dot</span>(annotations<span class="op">,</span> {</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>            <span class="dt">r</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>          })</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">arrow</span>(annotations<span class="op">,</span> {</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y1</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> <span class="st">"endDate"</span><span class="op">,</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y2</span><span class="op">:</span> <span class="st">"endCount"</span><span class="op">,</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>      <span class="co">// dx: 14,</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>      <span class="dt">inset</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>      <span class="dt">head</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> <span class="fl">0.5</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    })    </span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span> </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">500</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">""</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;details&gt;&lt;summary&gt;Dérouler la &lt;i&gt;timeline&lt;/i&gt; du réseau&lt;/summary&gt;</span><span class="sc">${</span>annotations</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> i) <span class="kw">=&gt;</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>              <span class="vs">`(</span><span class="sc">${</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="vs">) </span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>                <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>              })<span class="sc">}</span><span class="vs"> – </span><span class="sc">${</span>d<span class="op">.</span><span class="at">text</span><span class="sc">}</span><span class="vs"> `</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">join</span>(<span class="st">"&lt;br&gt;"</span>)<span class="sc">}</span><span class="vs">&lt;/details&gt;`</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>})<span class="op">,</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"blue"</span><span class="op">,</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
<section id="evolution-composition-réseau" class="level2">
<h2 class="anchored" data-anchor-id="evolution-composition-réseau">Evolution composition réseau</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="178" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 177;"><span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>viewof input_date <span class="op">=</span> <span class="fu">Scrubber</span>(</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>  serie_contacts_domain<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> {</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>  <span class="dt">delay</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>  <span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>  <span class="dt">unique</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sort</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> date <span class="kw">=&gt;</span> date<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"en"</span><span class="op">,</span> {<span class="dt">month</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span> <span class="dt">day</span><span class="op">:</span> <span class="st">"numeric"</span>})</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="192" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 191;"><span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="co">// Source: https://observablehq.com/@mbostock/dashboard</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #fff;</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin: 0;</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: none ;</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: grid;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: </span><span class="sc">${</span><span class="bu">screen</span><span class="op">.</span><span class="at">width</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a><span class="vs">  grid-template-areas: </span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a><span class="vs">    'a b'</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a><span class="vs">    'a b'</span></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a><span class="vs">    'a b'</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a><span class="vs">    'c c';</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a><span class="vs">  grid-gap: 10px;</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a><span class="vs">"&gt;</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div name="a" style="grid-area: a; position: relative;"&gt;</span><span class="sc">${</span>plt2<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div name="b" style="grid-area: b; position: relative;"&gt;</span><span class="sc">${</span>plt1<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div name="c" style="grid-area: c; position: relative;"&gt;</span><span class="sc">${</span>plt3<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="217" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 216;"><span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a><span class="co">// Line for network</span></span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>plt1 <span class="op">=</span> <span class="fu">addTooltips</span>(</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">110</span><span class="op">,</span><span class="dv">320</span>]<span class="op">,</span></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ Nombre d'inscrits à la liste de diffusion"</span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">dot</span>(serie_contacts<span class="op">,</span></span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fill</span><span class="op">:</span> <span class="st">"#6886bb"</span><span class="op">,</span></span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>                })<span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> </span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> inscrits `</span></span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>                <span class="co">//marker: "circle",</span></span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>                <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span>   </span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(serie_contacts<span class="op">,</span></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>                <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#6886bb"</span></span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>                <span class="co">//marker: "circle",</span></span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>                <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span>   </span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">dot</span>(serie_contacts<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="fu">dateFormat</span>(d<span class="op">.</span><span class="at">date</span>) <span class="op">&lt;=</span> <span class="fu">dateFormat</span>(input_date))<span class="op">,</span></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>                                <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>                            })<span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> </span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> inscrits `</span>            </span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>                <span class="co">//marker: "circle",</span></span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>                <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span> </span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(serie_contacts<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="fu">dateFormat</span>(d<span class="op">.</span><span class="at">date</span>) <span class="op">&lt;=</span> <span class="fu">dateFormat</span>(input_date))<span class="op">,</span></span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span></span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>                <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span></span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>                <span class="co">//marker: "circle",</span></span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>                <span class="co">//curve: "step", strokeWidth: 1</span></span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span>   </span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">arrow</span>(annotations<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="fu">dateFormat</span>(d<span class="op">.</span><span class="at">date</span>) <span class="op">==</span> <span class="fu">dateFormat</span>(input_date))<span class="op">,</span> {</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x2</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y1</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x1</span><span class="op">:</span> <span class="st">"endDate"</span><span class="op">,</span></span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y2</span><span class="op">:</span> <span class="st">"endCount"</span><span class="op">,</span></span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>        <span class="co">// dx: 14,</span></span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>        <span class="dt">inset</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>        <span class="dt">head</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeOpacity</span><span class="op">:</span> <span class="fl">0.5</span></span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>(annotations<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="fu">dateFormat</span>(d<span class="op">.</span><span class="at">date</span>) <span class="op">==</span> <span class="fu">dateFormat</span>(input_date))<span class="op">,</span> {</span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y</span><span class="op">:</span> <span class="st">"textCount"</span><span class="op">,</span></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">lineHeight</span><span class="op">:</span> <span class="fl">1.3</span><span class="op">,</span></span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">width</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>                        <span class="vs">`</span><span class="sc">${</span><span class="kw">new</span> <span class="bu">Date</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">.</span><span class="fu">toLocaleDateString</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">timeZone</span><span class="op">:</span> <span class="st">"UTC"</span></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>                        })<span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> </span><span class="sc">${</span>d<span class="op">.</span><span class="at">text</span><span class="sc">}</span><span class="vs"> `</span><span class="op">,</span></span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span></span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>                })        </span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span> </span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"green"</span><span class="op">,</span></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span></span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="300" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 299;"><span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>dateFormat <span class="op">=</span> d3<span class="op">.</span><span class="fu">utcFormat</span>(<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a>subset <span class="op">=</span> serie_contacts_domain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="fu">dateFormat</span>(d<span class="op">.</span><span class="at">date</span>) <span class="op">==</span> <span class="fu">dateFormat</span>(input_date))</span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a>order_domain <span class="op">=</span> d3<span class="op">.</span><span class="fu">groupSort</span>(</span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a>  serie_contacts_domain<span class="op">,</span></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a>  (g) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">max</span>(g<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">mail</span>)<span class="op">,</span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a>  (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="311" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 310;"><span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a>array1 <span class="op">=</span> ssp<span class="op">.</span><span class="fu">concat</span>(autres_ssp)</span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>array2 <span class="op">=</span> subset<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span>)</span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a>hors_ssp_all <span class="op">=</span> serie_contacts_domain<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="op">!</span>array1<span class="op">.</span><span class="fu">includes</span>(d))</span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a>hors_ssp <span class="op">=</span> [<span class="op">...</span> <span class="kw">new</span> <span class="bu">Set</span>(hors_ssp_all)]</span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a>colors_hors_ssp <span class="op">=</span> <span class="bu">Array</span>(hors_ssp<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="st">"#fb9a99"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="320" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 319;"><span id="cb7-320"><a href="#cb7-320" aria-hidden="true" tabindex="-1"></a>ssp <span class="op">=</span> [</span>
<span id="cb7-321"><a href="#cb7-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">'INSEE'</span><span class="op">,</span> <span class="st">'Santé'</span><span class="op">,</span> <span class="st">'Développement Durable'</span><span class="op">,</span> <span class="st">'Agriculture'</span><span class="op">,</span> <span class="st">'Finances'</span><span class="op">,</span> <span class="st">'Travail'</span><span class="op">,</span> <span class="st">'Intérieur'</span><span class="op">,</span> <span class="st">'Recherche'</span></span>
<span id="cb7-322"><a href="#cb7-322" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-323"><a href="#cb7-323" aria-hidden="true" tabindex="-1"></a>autres_ssp <span class="op">=</span> [<span class="st">'Justice'</span><span class="op">,</span> <span class="st">'Culture'</span><span class="op">,</span> <span class="st">"Collectivités Locales"</span><span class="op">,</span> <span class="st">"Enseignement Supérieur"</span><span class="op">,</span></span>
<span id="cb7-324"><a href="#cb7-324" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Jeunesse Sports"</span><span class="op">,</span> <span class="st">"Défense"</span>]</span>
<span id="cb7-325"><a href="#cb7-325" aria-hidden="true" tabindex="-1"></a>colors_autres_ssp <span class="op">=</span> <span class="bu">Array</span>(<span class="dv">6</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="330" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 329;"><span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a>plt2 <span class="op">=</span> <span class="fu">addTooltips</span>(</span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a>    <span class="dt">paddingTop</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span></span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a>    <span class="dt">projection</span><span class="op">:</span> {</span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a>        <span class="co">// equal-area is crucial to maintain comparability of the slices,</span></span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a>        <span class="co">// but it could be any other equal-area projection</span></span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"azimuthal-equal-area"</span><span class="op">,</span> </span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a>        <span class="dt">rotate</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">180</span> <span class="op">-</span> <span class="dv">90</span>]</span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span><span class="op">,</span></span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> </span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Institution"</span><span class="op">,</span></span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> ssp<span class="op">.</span><span class="fu">concat</span>(autres_ssp)<span class="op">.</span><span class="fu">concat</span>(hors_ssp)<span class="op">,</span> </span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a>        <span class="dt">range</span><span class="op">:</span> [</span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#5a5758"</span><span class="op">,</span> <span class="st">"#9cb5b8"</span><span class="op">,</span> <span class="st">"forestgreen"</span><span class="op">,</span> <span class="st">"#e8d630"</span><span class="op">,</span> <span class="st">"gold"</span><span class="op">,</span> <span class="st">"#2d378c"</span><span class="op">,</span> <span class="st">"brown"</span><span class="op">,</span> <span class="st">"lavender"</span></span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">.</span><span class="fu">concat</span>(colors_autres_ssp)<span class="op">.</span><span class="fu">concat</span>(colors_hors_ssp)</span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a>    <span class="dt">sort</span><span class="op">:</span> {</span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">"stroke"</span><span class="op">,</span></span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a>            <span class="dt">reduce</span><span class="op">:</span> <span class="st">"count"</span><span class="op">,</span></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a>            <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> ssp<span class="op">.</span><span class="fu">concat</span>(autres_ssp)<span class="op">.</span><span class="fu">concat</span>(hors_ssp)</span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span>    </span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pie</span>(</span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a>            subset<span class="op">,</span> {</span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span></span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> (</span><span class="sc">${</span>(d<span class="op">.</span><span class="at">mail</span> <span class="op">/</span> d3<span class="op">.</span><span class="fu">sum</span>(subset<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">mail</span>))<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="kw">undefined</span><span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="st">"percent"</span>})<span class="sc">}</span><span class="vs"> du total)`</span> </span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a>                })        </span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">fill</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="st">"stroke-width"</span><span class="op">:</span> <span class="st">"3px"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span> } </span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="369" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 368;"><span id="cb9-369"><a href="#cb9-369" aria-hidden="true" tabindex="-1"></a>plt3 <span class="op">=</span> <span class="fu">addTooltips</span>(</span>
<span id="cb9-370"><a href="#cb9-370" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb9-371"><a href="#cb9-371" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb9-372"><a href="#cb9-372" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"Institution"</span></span>
<span id="cb9-373"><a href="#cb9-373" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-374"><a href="#cb9-374" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb9-375"><a href="#cb9-375" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"Nombre d'inscrits à la liste de diffusion →"</span></span>
<span id="cb9-376"><a href="#cb9-376" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-377"><a href="#cb9-377" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">150</span><span class="op">,</span></span>
<span id="cb9-378"><a href="#cb9-378" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb9-379"><a href="#cb9-379" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span><span class="op">,</span></span>
<span id="cb9-380"><a href="#cb9-380" aria-hidden="true" tabindex="-1"></a>            <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> </span>
<span id="cb9-381"><a href="#cb9-381" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"Institution"</span><span class="op">,</span></span>
<span id="cb9-382"><a href="#cb9-382" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> ssp<span class="op">.</span><span class="fu">concat</span>(autres_ssp)<span class="op">.</span><span class="fu">concat</span>(hors_ssp)<span class="op">,</span> </span>
<span id="cb9-383"><a href="#cb9-383" aria-hidden="true" tabindex="-1"></a>            <span class="dt">range</span><span class="op">:</span> [</span>
<span id="cb9-384"><a href="#cb9-384" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#5a5758"</span><span class="op">,</span> <span class="st">"#9cb5b8"</span><span class="op">,</span> <span class="st">"forestgreen"</span><span class="op">,</span> <span class="st">"#e8d630"</span><span class="op">,</span> <span class="st">"gold"</span><span class="op">,</span> <span class="st">"#2d378c"</span><span class="op">,</span> <span class="st">"brown"</span><span class="op">,</span> <span class="st">"lavender"</span></span>
<span id="cb9-385"><a href="#cb9-385" aria-hidden="true" tabindex="-1"></a>                ]<span class="op">.</span><span class="fu">concat</span>(colors_autres_ssp)<span class="op">.</span><span class="fu">concat</span>(colors_hors_ssp)<span class="op">,</span></span>
<span id="cb9-386"><a href="#cb9-386" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-387"><a href="#cb9-387" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb9-388"><a href="#cb9-388" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">barX</span>(</span>
<span id="cb9-389"><a href="#cb9-389" aria-hidden="true" tabindex="-1"></a>            subset<span class="op">,</span></span>
<span id="cb9-390"><a href="#cb9-390" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb9-391"><a href="#cb9-391" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span> <span class="dt">sort</span><span class="op">:</span> {<span class="dt">y</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb9-392"><a href="#cb9-392" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> (</span><span class="sc">${</span>(d<span class="op">.</span><span class="at">mail</span> <span class="op">/</span> d3<span class="op">.</span><span class="fu">sum</span>(subset<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">mail</span>))<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="kw">undefined</span><span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="st">"percent"</span>})<span class="sc">}</span><span class="vs"> du total)`</span><span class="op">,</span></span>
<span id="cb9-393"><a href="#cb9-393" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb9-394"><a href="#cb9-394" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb9-395"><a href="#cb9-395" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>(subset<span class="op">,</span></span>
<span id="cb9-396"><a href="#cb9-396" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb9-397"><a href="#cb9-397" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb9-398"><a href="#cb9-398" aria-hidden="true" tabindex="-1"></a>            <span class="dt">text</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">mail</span><span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span>(d<span class="op">.</span><span class="at">mail</span> <span class="op">/</span> d3<span class="op">.</span><span class="fu">sum</span>(subset<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">mail</span>))<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="kw">undefined</span><span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="st">"percent"</span>})<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb9-399"><a href="#cb9-399" aria-hidden="true" tabindex="-1"></a>            <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span></span>
<span id="cb9-400"><a href="#cb9-400" aria-hidden="true" tabindex="-1"></a>        })      </span>
<span id="cb9-401"><a href="#cb9-401" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb9-402"><a href="#cb9-402" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-403"><a href="#cb9-403" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">fill</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="st">"stroke-width"</span><span class="op">:</span> <span class="st">"3px"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span> } </span>
<span id="cb9-404"><a href="#cb9-404" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
</section>
<section id="répartition-des-modes-daccès-au-réseau" class="level2">
<h2 class="anchored" data-anchor-id="répartition-des-modes-daccès-au-réseau">Répartition des modes d’accès au réseau</h2>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="415" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 414;"><span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a>stats_tchap_vs_outlook <span class="op">=</span> db<span class="op">.</span><span class="fu">sql</span><span class="vs">`</span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT source, domain, CAST(COUNT(*) AS int) AS count</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM latest</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="vs">WHERE domain IN (SELECT domain</span></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="vs">                FROM latest</span></span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="vs">                GROUP BY domain</span></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a><span class="vs">                HAVING COUNT(*) &gt; 10)</span></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a><span class="vs">GROUP BY source, domain</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a>stats_all <span class="op">=</span> db<span class="op">.</span><span class="fu">sql</span><span class="vs">`</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT source, domain, CAST(COUNT(*) AS int) AS count</span></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM latest</span></span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a><span class="vs">GROUP BY source, domain</span></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="435" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 434;"><span id="cb11-435"><a href="#cb11-435" aria-hidden="true" tabindex="-1"></a><span class="fu">addTooltips</span>(</span>
<span id="cb11-436"><a href="#cb11-436" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb11-437"><a href="#cb11-437" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb11-438"><a href="#cb11-438" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> order_domain_all<span class="op">,</span></span>
<span id="cb11-439"><a href="#cb11-439" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Institution"</span></span>
<span id="cb11-440"><a href="#cb11-440" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span>        </span>
<span id="cb11-441"><a href="#cb11-441" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb11-442"><a href="#cb11-442" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-443"><a href="#cb11-443" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ Nombre d'inscrits"</span></span>
<span id="cb11-444"><a href="#cb11-444" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb11-445"><a href="#cb11-445" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb11-446"><a href="#cb11-446" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-447"><a href="#cb11-447" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span><span class="op">,</span></span>
<span id="cb11-448"><a href="#cb11-448" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scheme</span><span class="op">:</span> <span class="st">"pastel1"</span><span class="op">,</span></span>
<span id="cb11-449"><a href="#cb11-449" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="st">"Diffusion mail et Tchap"</span><span class="op">,</span> <span class="st">"Diffusion mail"</span><span class="op">,</span> <span class="st">"Tchap"</span>] <span class="co">// setting the order manually by specifying the array</span></span>
<span id="cb11-450"><a href="#cb11-450" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb11-451"><a href="#cb11-451" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb11-452"><a href="#cb11-452" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">barY</span>(stats_tchap_vs_outlook<span class="op">,</span></span>
<span id="cb11-453"><a href="#cb11-453" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb11-454"><a href="#cb11-454" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"count"</span><span class="op">,</span> <span class="dt">sort</span><span class="op">:</span> <span class="st">"source"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"source"</span><span class="op">,</span></span>
<span id="cb11-455"><a href="#cb11-455" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">source</span><span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">count</span><span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs"> (</span><span class="sc">${</span>(d<span class="op">.</span><span class="at">count</span> <span class="op">/</span> d3<span class="op">.</span><span class="fu">sum</span>(stats_tchap_vs_outlook<span class="op">.</span><span class="fu">filter</span>(t <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">domain</span> <span class="op">==</span> d<span class="op">.</span><span class="at">domain</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">count</span>))<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="kw">undefined</span><span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="st">"percent"</span>})<span class="sc">}</span><span class="vs">)`</span> </span>
<span id="cb11-456"><a href="#cb11-456" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb11-457"><a href="#cb11-457" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])</span>
<span id="cb11-458"><a href="#cb11-458" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> { <span class="dt">paddingTop</span><span class="op">:</span> <span class="dv">50</span>}<span class="op">,</span></span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;details&gt;&lt;summary&gt;Dérouler la note:&lt;/summary&gt;&lt;i&gt;Seules les institutions comportant au moins 10 inscrits sont présentées dans ce graphique&lt;/i&gt;&lt;/details&gt;`</span></span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Set styles for the hovered element</span></span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">fill</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="st">"stroke-width"</span><span class="op">:</span> <span class="st">"3px"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span> }    </span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="468" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 467;"><span id="cb12-468"><a href="#cb12-468" aria-hidden="true" tabindex="-1"></a>order_domain_all <span class="op">=</span> d3<span class="op">.</span><span class="fu">groupSort</span>(</span>
<span id="cb12-469"><a href="#cb12-469" aria-hidden="true" tabindex="-1"></a>  stats_tchap_vs_outlook<span class="op">,</span></span>
<span id="cb12-470"><a href="#cb12-470" aria-hidden="true" tabindex="-1"></a>  (g) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(g<span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="op">-</span>d<span class="op">.</span><span class="at">count</span>)<span class="op">,</span></span>
<span id="cb12-471"><a href="#cb12-471" aria-hidden="true" tabindex="-1"></a>  (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span></span>
<span id="cb12-472"><a href="#cb12-472" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-473"><a href="#cb12-473" aria-hidden="true" tabindex="-1"></a><span class="co">//viewof tt = Inputs.table(stats_tchap_vs_outlook)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="478" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 477;"><span id="cb13-478"><a href="#cb13-478" aria-hidden="true" tabindex="-1"></a>annotations <span class="op">=</span> [</span>
<span id="cb13-479"><a href="#cb13-479" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-480"><a href="#cb13-480" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-02-22"</span>)<span class="op">,</span></span>
<span id="cb13-481"><a href="#cb13-481" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-02-22"</span>)<span class="op">,</span></span>
<span id="cb13-482"><a href="#cb13-482" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">112</span><span class="op">,</span></span>
<span id="cb13-483"><a href="#cb13-483" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°1 🎉"</span><span class="op">,</span></span>
<span id="cb13-484"><a href="#cb13-484" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-02-23"</span><span class="op">,</span></span>
<span id="cb13-485"><a href="#cb13-485" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb13-486"><a href="#cb13-486" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb13-487"><a href="#cb13-487" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-488"><a href="#cb13-488" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-489"><a href="#cb13-489" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-03-17"</span>)<span class="op">,</span></span>
<span id="cb13-490"><a href="#cb13-490" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-03-17"</span>)<span class="op">,</span></span>
<span id="cb13-491"><a href="#cb13-491" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">153</span><span class="op">,</span></span>
<span id="cb13-492"><a href="#cb13-492" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°2"</span><span class="op">,</span></span>
<span id="cb13-493"><a href="#cb13-493" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-02-23"</span><span class="op">,</span></span>
<span id="cb13-494"><a href="#cb13-494" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">230</span><span class="op">,</span></span>
<span id="cb13-495"><a href="#cb13-495" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">5</span></span>
<span id="cb13-496"><a href="#cb13-496" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-497"><a href="#cb13-497" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-498"><a href="#cb13-498" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-04-22"</span>)<span class="op">,</span></span>
<span id="cb13-499"><a href="#cb13-499" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-04-22"</span>)<span class="op">,</span></span>
<span id="cb13-500"><a href="#cb13-500" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">188</span><span class="op">,</span></span>
<span id="cb13-501"><a href="#cb13-501" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°3"</span><span class="op">,</span></span>
<span id="cb13-502"><a href="#cb13-502" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-04-14"</span><span class="op">,</span></span>
<span id="cb13-503"><a href="#cb13-503" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">140</span><span class="op">,</span></span>
<span id="cb13-504"><a href="#cb13-504" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb13-505"><a href="#cb13-505" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-506"><a href="#cb13-506" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-507"><a href="#cb13-507" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-05-14"</span>)<span class="op">,</span></span>
<span id="cb13-508"><a href="#cb13-508" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-05-14"</span>)<span class="op">,</span></span>
<span id="cb13-509"><a href="#cb13-509" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">212</span><span class="op">,</span></span>
<span id="cb13-510"><a href="#cb13-510" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°4"</span><span class="op">,</span></span>
<span id="cb13-511"><a href="#cb13-511" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-05-23"</span><span class="op">,</span></span>
<span id="cb13-512"><a href="#cb13-512" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">180</span><span class="op">,</span></span>
<span id="cb13-513"><a href="#cb13-513" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb13-514"><a href="#cb13-514" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-515"><a href="#cb13-515" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-516"><a href="#cb13-516" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-06-14"</span>)<span class="op">,</span></span>
<span id="cb13-517"><a href="#cb13-517" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-06-17"</span>)<span class="op">,</span></span>
<span id="cb13-518"><a href="#cb13-518" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">227</span><span class="op">,</span></span>
<span id="cb13-519"><a href="#cb13-519" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°5"</span><span class="op">,</span></span>
<span id="cb13-520"><a href="#cb13-520" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-06-15"</span><span class="op">,</span></span>
<span id="cb13-521"><a href="#cb13-521" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">160</span><span class="op">,</span></span>
<span id="cb13-522"><a href="#cb13-522" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb13-523"><a href="#cb13-523" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-524"><a href="#cb13-524" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-525"><a href="#cb13-525" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-10-26"</span>)<span class="op">,</span></span>
<span id="cb13-526"><a href="#cb13-526" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-10-26"</span>)<span class="op">,</span></span>
<span id="cb13-527"><a href="#cb13-527" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">261</span><span class="op">,</span></span>
<span id="cb13-528"><a href="#cb13-528" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°6"</span><span class="op">,</span></span>
<span id="cb13-529"><a href="#cb13-529" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-10-26"</span><span class="op">,</span></span>
<span id="cb13-530"><a href="#cb13-530" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">295</span><span class="op">,</span></span>
<span id="cb13-531"><a href="#cb13-531" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb13-532"><a href="#cb13-532" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-533"><a href="#cb13-533" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-534"><a href="#cb13-534" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-11-30"</span>)<span class="op">,</span></span>
<span id="cb13-535"><a href="#cb13-535" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-11-30"</span>)<span class="op">,</span></span>
<span id="cb13-536"><a href="#cb13-536" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">282</span><span class="op">,</span></span>
<span id="cb13-537"><a href="#cb13-537" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Newsletter n°7"</span><span class="op">,</span></span>
<span id="cb13-538"><a href="#cb13-538" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-11-30"</span><span class="op">,</span></span>
<span id="cb13-539"><a href="#cb13-539" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">230</span><span class="op">,</span></span>
<span id="cb13-540"><a href="#cb13-540" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb13-541"><a href="#cb13-541" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-542"><a href="#cb13-542" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-543"><a href="#cb13-543" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-04-22"</span>)<span class="op">,</span></span>
<span id="cb13-544"><a href="#cb13-544" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-04-22"</span>)<span class="op">,</span></span>
<span id="cb13-545"><a href="#cb13-545" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">188</span><span class="op">,</span></span>
<span id="cb13-546"><a href="#cb13-546" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"OpenHour n°1"</span><span class="op">,</span></span>
<span id="cb13-547"><a href="#cb13-547" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-04-22"</span><span class="op">,</span></span>
<span id="cb13-548"><a href="#cb13-548" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb13-549"><a href="#cb13-549" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb13-550"><a href="#cb13-550" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-551"><a href="#cb13-551" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-552"><a href="#cb13-552" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-06-03"</span>)<span class="op">,</span></span>
<span id="cb13-553"><a href="#cb13-553" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-06-03"</span>)<span class="op">,</span></span>
<span id="cb13-554"><a href="#cb13-554" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">220</span><span class="op">,</span></span>
<span id="cb13-555"><a href="#cb13-555" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"OpenHour n°2"</span><span class="op">,</span></span>
<span id="cb13-556"><a href="#cb13-556" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-06-03"</span><span class="op">,</span></span>
<span id="cb13-557"><a href="#cb13-557" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">270</span><span class="op">,</span></span>
<span id="cb13-558"><a href="#cb13-558" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb13-559"><a href="#cb13-559" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-560"><a href="#cb13-560" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-561"><a href="#cb13-561" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-09-13"</span>)<span class="op">,</span></span>
<span id="cb13-562"><a href="#cb13-562" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-09-13"</span>)<span class="op">,</span></span>
<span id="cb13-563"><a href="#cb13-563" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">232</span><span class="op">,</span></span>
<span id="cb13-564"><a href="#cb13-564" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Nouvelle version du site web"</span><span class="op">,</span></span>
<span id="cb13-565"><a href="#cb13-565" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-09-13"</span><span class="op">,</span></span>
<span id="cb13-566"><a href="#cb13-566" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">150</span></span>
<span id="cb13-567"><a href="#cb13-567" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-568"><a href="#cb13-568" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-569"><a href="#cb13-569" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-09-30"</span>)<span class="op">,</span></span>
<span id="cb13-570"><a href="#cb13-570" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-09-30"</span>)<span class="op">,</span></span>
<span id="cb13-571"><a href="#cb13-571" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">245</span><span class="op">,</span></span>
<span id="cb13-572"><a href="#cb13-572" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">"Premier post de blog"</span><span class="op">,</span></span>
<span id="cb13-573"><a href="#cb13-573" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-09-30"</span><span class="op">,</span></span>
<span id="cb13-574"><a href="#cb13-574" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">205</span><span class="op">,</span></span>
<span id="cb13-575"><a href="#cb13-575" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb13-576"><a href="#cb13-576" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-577"><a href="#cb13-577" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-578"><a href="#cb13-578" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-11-16"</span>)<span class="op">,</span></span>
<span id="cb13-579"><a href="#cb13-579" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endDate</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">utcParse</span>(<span class="st">"%Y-%m-%d"</span>)(<span class="st">"2022-11-16"</span>)<span class="op">,</span></span>
<span id="cb13-580"><a href="#cb13-580" aria-hidden="true" tabindex="-1"></a>    <span class="dt">endCount</span><span class="op">:</span> <span class="dv">275</span><span class="op">,</span></span>
<span id="cb13-581"><a href="#cb13-581" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> <span class="vs">`Présentation observable</span><span class="sc">\n</span><span class="vs">par Nicolas Lambert`</span><span class="op">,</span></span>
<span id="cb13-582"><a href="#cb13-582" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textDate</span><span class="op">:</span> <span class="st">"2022-09-13"</span><span class="op">,</span></span>
<span id="cb13-583"><a href="#cb13-583" aria-hidden="true" tabindex="-1"></a>    <span class="dt">textCount</span><span class="op">:</span> <span class="dv">150</span><span class="op">,</span></span>
<span id="cb13-584"><a href="#cb13-584" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bend</span><span class="op">:</span> <span class="dv">20</span></span>
<span id="cb13-585"><a href="#cb13-585" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb13-586"><a href="#cb13-586" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
</section>
<section id="composition-du-réseau" class="level1">
<h1>Composition du réseau</h1>
<p>Composition de la liste de diffusion mail</p>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb14" data-startfrom="597" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 596;"><span id="cb14-597"><a href="#cb14-597" aria-hidden="true" tabindex="-1"></a><span class="fu">addTooltips</span>(</span>
<span id="cb14-598"><a href="#cb14-598" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb14-599"><a href="#cb14-599" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb14-600"><a href="#cb14-600" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ Count"</span><span class="op">,</span></span>
<span id="cb14-601"><a href="#cb14-601" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-602"><a href="#cb14-602" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb14-603"><a href="#cb14-603" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">areaY</span>(</span>
<span id="cb14-604"><a href="#cb14-604" aria-hidden="true" tabindex="-1"></a>            serie_contacts_domain<span class="op">,</span></span>
<span id="cb14-605"><a href="#cb14-605" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"mail"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span></span>
<span id="cb14-606"><a href="#cb14-606" aria-hidden="true" tabindex="-1"></a>            <span class="dt">z</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span></span>
<span id="cb14-607"><a href="#cb14-607" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> <span class="st">"domain"</span><span class="op">,</span></span>
<span id="cb14-608"><a href="#cb14-608" aria-hidden="true" tabindex="-1"></a>            <span class="dt">order</span><span class="op">:</span> <span class="st">"max"</span><span class="op">,</span></span>
<span id="cb14-609"><a href="#cb14-609" aria-hidden="true" tabindex="-1"></a>            <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb14-610"><a href="#cb14-610" aria-hidden="true" tabindex="-1"></a>            <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#ddd"</span></span>
<span id="cb14-611"><a href="#cb14-611" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span> <span class="co">// implicit stacking</span></span>
<span id="cb14-612"><a href="#cb14-612" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])</span>
<span id="cb14-613"><a href="#cb14-613" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb14-614"><a href="#cb14-614" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb14-615"><a href="#cb14-615" aria-hidden="true" tabindex="-1"></a>        <span class="dt">pointerEvents</span><span class="op">:</span> <span class="st">"all"</span></span>
<span id="cb14-616"><a href="#cb14-616" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-617"><a href="#cb14-617" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb14-618"><a href="#cb14-618" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb14-619"><a href="#cb14-619" aria-hidden="true" tabindex="-1"></a>      <span class="dt">columns</span><span class="op">:</span> <span class="st">"110px"</span><span class="op">,</span></span>
<span id="cb14-620"><a href="#cb14-620" aria-hidden="true" tabindex="-1"></a>      <span class="dt">width</span><span class="op">:</span> <span class="dv">640</span><span class="op">,</span></span>
<span id="cb14-621"><a href="#cb14-621" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span></span>
<span id="cb14-622"><a href="#cb14-622" aria-hidden="true" tabindex="-1"></a>    }    </span>
<span id="cb14-623"><a href="#cb14-623" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb14-624"><a href="#cb14-624" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code" id="cb15" data-startfrom="630" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 629;"><span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>configuredClient <span class="op">=</span> {</span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> client <span class="op">=</span> <span class="cf">await</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>()<span class="op">;</span></span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> client<span class="op">.</span><span class="fu">sql</span><span class="vs">`</span></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a><span class="vs">    SET s3_endpoint='minio.lab.sspcloud.fr'</span></span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> client<span class="op">;</span></span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>url_latest <span class="op">=</span> <span class="st">'s3://lgaliana/ssphub/files/retrospective2022-observable/list_contacts_latest.parquet'</span></span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>url_latest2 <span class="op">=</span> <span class="st">'s3://lgaliana/ssphub/files/retrospective2022-observable/series_nombre_contact.parquet'</span></span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> {</span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> configuredClient<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW latest AS </span></span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT * FROM read_parquet('</span><span class="sc">${</span>url_latest<span class="sc">}</span><span class="vs">') ;</span></span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="op">;</span></span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> configuredClient<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW serie AS </span></span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT * FROM read_parquet('</span><span class="sc">${</span>url_latest2<span class="sc">}</span><span class="vs">') ;</span></span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="op">;</span></span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> configuredClient</span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code" id="cb16" data-startfrom="658" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 657;"><span id="cb16-658"><a href="#cb16-658" aria-hidden="true" tabindex="-1"></a><span class="fu">SummaryTable</span>(serie_contacts_domain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell" data-eval="true">
<div class="sourceCode cell-code" id="cb17" data-startfrom="664" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 663;"><span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a>serie_contacts <span class="op">=</span> db<span class="op">.</span><span class="fu">sql</span><span class="vs">`</span></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT date, CAST(SUM(mail) AS int) AS mail</span></span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM serie</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a><span class="vs">GROUP BY date</span></span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a>serie_contacts_domain <span class="op">=</span> db<span class="op">.</span><span class="fu">sql</span><span class="vs">`</span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT date, domain, CAST(mail AS int) AS mail</span></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM serie</span></span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-17-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-startfrom="681" data-source-offset="-47"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 680;"><span id="cb18-681"><a href="#cb18-681" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {addTooltips} <span class="im">from</span> <span class="st">"@mkfreeman/plot-tooltip"</span></span>
<span id="cb18-682"><a href="#cb18-682" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {SummaryTable} <span class="im">from</span> <span class="st">"@observablehq/summary-table"</span></span>
<span id="cb18-683"><a href="#cb18-683" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {Treemap} <span class="im">from</span> <span class="st">"@d3/treemap"</span></span>
<span id="cb18-684"><a href="#cb18-684" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { style <span class="im">as</span> faStyle<span class="op">,</span> fa<span class="op">,</span> fas } <span class="im">from</span> <span class="st">"@airbornemint/fontawesome"</span></span>
<span id="cb18-685"><a href="#cb18-685" aria-hidden="true" tabindex="-1"></a><span class="fu">faStyle</span>({<span class="dt">regular</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">solid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">brands</span><span class="op">:</span> <span class="kw">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb19" data-startfrom="686" data-source-offset="-314"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 685;"><span id="cb19-686"><a href="#cb19-686" aria-hidden="true" tabindex="-1"></a>Plot <span class="op">=</span> <span class="pp">require</span>(<span class="st">'@observablehq/plot@0.6.1/dist/plot.umd.min.js'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="691" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 690;"><span id="cb20-691"><a href="#cb20-691" aria-hidden="true" tabindex="-1"></a><span class="co">// Borrowed to https://observablehq.com/@observablehq/whats-different-timeseries-forecast-performance?collection=@observablehq/analyzing-time-series-data</span></span>
<span id="cb20-692"><a href="#cb20-692" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb20-693"><a href="#cb20-693" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"Infolettre"</span><span class="op">,</span> <span class="st">"#6886bb"</span>]<span class="op">,</span> </span>
<span id="cb20-694"><a href="#cb20-694" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"Event"</span><span class="op">,</span> <span class="st">"#a2a5ba"</span>]</span>
<span id="cb20-695"><a href="#cb20-695" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-startfrom="701" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 700;"><span id="cb21-701"><a href="#cb21-701" aria-hidden="true" tabindex="-1"></a>pie <span class="op">=</span> (data<span class="op">,</span> { value<span class="op">,</span> <span class="op">...</span>options }) <span class="kw">=&gt;</span> {</span>
<span id="cb21-702"><a href="#cb21-702" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cs <span class="op">=</span> d3<span class="op">.</span><span class="fu">cumsum</span>(data<span class="op">,</span> (d) <span class="kw">=&gt;</span> d[value])<span class="op">;</span></span>
<span id="cb21-703"><a href="#cb21-703" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> r <span class="op">=</span> <span class="dv">360</span> <span class="op">/</span> cs[cs<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb21-704"><a href="#cb21-704" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> cs<span class="op">.</span><span class="at">length</span><span class="op">;</span> <span class="op">++</span>i) cs[i] <span class="op">*=</span> r<span class="op">;</span></span>
<span id="cb21-705"><a href="#cb21-705" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> d <span class="kw">of</span> data)</span>
<span id="cb21-706"><a href="#cb21-706" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">geo</span>(</span>
<span id="cb21-707"><a href="#cb21-707" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb21-708"><a href="#cb21-708" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"GeometryCollection"</span><span class="op">,</span></span>
<span id="cb21-709"><a href="#cb21-709" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geometries</span><span class="op">:</span> data<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb21-710"><a href="#cb21-710" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> a <span class="op">=</span> <span class="op">-</span>(cs[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">||</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb21-711"><a href="#cb21-711" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> b <span class="op">=</span> <span class="op">-</span>cs[i]<span class="op">;</span></span>
<span id="cb21-712"><a href="#cb21-712" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> {</span>
<span id="cb21-713"><a href="#cb21-713" aria-hidden="true" tabindex="-1"></a>            <span class="dt">type</span><span class="op">:</span> <span class="st">"Polygon"</span><span class="op">,</span></span>
<span id="cb21-714"><a href="#cb21-714" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span>d<span class="op">,</span></span>
<span id="cb21-715"><a href="#cb21-715" aria-hidden="true" tabindex="-1"></a>            <span class="dt">coordinates</span><span class="op">:</span> [</span>
<span id="cb21-716"><a href="#cb21-716" aria-hidden="true" tabindex="-1"></a>              [</span>
<span id="cb21-717"><a href="#cb21-717" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">0</span><span class="op">,</span> <span class="dv">90</span>]<span class="op">,</span></span>
<span id="cb21-718"><a href="#cb21-718" aria-hidden="true" tabindex="-1"></a>                [a<span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb21-719"><a href="#cb21-719" aria-hidden="true" tabindex="-1"></a>                [(<span class="dv">2</span> <span class="op">*</span> a <span class="op">+</span> b) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> <span class="co">// add intermediate points for sectors larger than a half-circle</span></span>
<span id="cb21-720"><a href="#cb21-720" aria-hidden="true" tabindex="-1"></a>                [(a <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> b) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb21-721"><a href="#cb21-721" aria-hidden="true" tabindex="-1"></a>                [b<span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb21-722"><a href="#cb21-722" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">0</span><span class="op">,</span> <span class="dv">90</span>]</span>
<span id="cb21-723"><a href="#cb21-723" aria-hidden="true" tabindex="-1"></a>              ]</span>
<span id="cb21-724"><a href="#cb21-724" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb21-725"><a href="#cb21-725" aria-hidden="true" tabindex="-1"></a>          }<span class="op">;</span></span>
<span id="cb21-726"><a href="#cb21-726" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-727"><a href="#cb21-727" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb21-728"><a href="#cb21-728" aria-hidden="true" tabindex="-1"></a>      { <span class="op">...</span>options }</span>
<span id="cb21-729"><a href="#cb21-729" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb21-730"><a href="#cb21-730" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" data-startfrom="735" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 734;"><span id="cb22-735"><a href="#cb22-735" aria-hidden="true" tabindex="-1"></a><span class="co">//addTooltips(</span></span>
<span id="cb22-736"><a href="#cb22-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Treemap</span>(stats_all<span class="op">,</span> {</span>
<span id="cb22-737"><a href="#cb22-737" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">?.</span><span class="at">count</span><span class="op">,</span> <span class="co">// size of each node (file); null for internal nodes (folders)</span></span>
<span id="cb22-738"><a href="#cb22-738" aria-hidden="true" tabindex="-1"></a>    <span class="dt">path</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span> <span class="op">+</span> <span class="st">"/"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">source</span><span class="op">,</span> <span class="co">// e.g., "flare/animate/Easing"</span></span>
<span id="cb22-739"><a href="#cb22-739" aria-hidden="true" tabindex="-1"></a>    <span class="dt">group</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span><span class="op">,</span> <span class="co">// e.g., "animate" in "flare.animate.Easing"; for color</span></span>
<span id="cb22-740"><a href="#cb22-740" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}\n${</span>d<span class="op">.</span><span class="at">source</span><span class="sc">}\n${</span>d<span class="op">.</span><span class="at">count</span><span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb22-741"><a href="#cb22-741" aria-hidden="true" tabindex="-1"></a>    <span class="co">//title: d =&gt; `${d.domain}\n${d.count.toLocaleString()}\n`, // text to show on </span></span>
<span id="cb22-742"><a href="#cb22-742" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}\n${</span>d<span class="op">.</span><span class="at">source</span><span class="sc">}\n${</span>d<span class="op">.</span><span class="at">count</span><span class="sc">}</span><span class="vs"> </span><span class="sc">\n</span><span class="vs">(</span><span class="sc">${</span>(d<span class="op">.</span><span class="at">count</span> <span class="op">/</span> d3<span class="op">.</span><span class="fu">sum</span>(stats_all<span class="op">.</span><span class="fu">filter</span>(t <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">domain</span> <span class="op">==</span> d<span class="op">.</span><span class="at">domain</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">count</span>))<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="kw">undefined</span><span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="st">"percent"</span>})<span class="sc">}</span><span class="vs"> des inscrits </span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb22-743"><a href="#cb22-743" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">1152</span><span class="op">,</span></span>
<span id="cb22-744"><a href="#cb22-744" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">1152</span><span class="op">,</span></span>
<span id="cb22-745"><a href="#cb22-745" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tile</span><span class="op">:</span> d3<span class="op">.</span><span class="at">treemapSquarify</span><span class="op">,</span></span>
<span id="cb22-746"><a href="#cb22-746" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colors</span><span class="op">:</span> [<span class="st">"#5a5758"</span><span class="op">,</span> <span class="st">"#9cb5b8"</span><span class="op">,</span> <span class="st">"forestgreen"</span><span class="op">,</span> <span class="st">"#e8d630"</span><span class="op">,</span> <span class="st">"gold"</span><span class="op">,</span> <span class="st">"#2d378c"</span><span class="op">,</span> <span class="st">"brown"</span><span class="op">,</span> <span class="st">"lavender"</span>]<span class="op">.</span><span class="fu">concat</span>(colors_autres_ssp)<span class="op">.</span><span class="fu">concat</span>(colors_hors_ssp)<span class="op">,</span> <span class="co">// array of colors</span></span>
<span id="cb22-747"><a href="#cb22-747" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zDomain</span><span class="op">:</span> ssp<span class="op">.</span><span class="fu">concat</span>(autres_ssp)<span class="op">.</span><span class="fu">concat</span>(hors_ssp)<span class="op">,</span> <span class="co">// array of values for the color scale</span></span>
<span id="cb22-748"><a href="#cb22-748" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span></span>
<span id="cb22-749"><a href="#cb22-749" aria-hidden="true" tabindex="-1"></a>    })<span class="co">//,</span></span>
<span id="cb22-750"><a href="#cb22-750" aria-hidden="true" tabindex="-1"></a>    <span class="co">//{ fill: "gray", opacity: 0.5, "stroke-width": "3px", stroke: "red" }    </span></span>
<span id="cb22-751"><a href="#cb22-751" aria-hidden="true" tabindex="-1"></a><span class="co">//)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell" data-eval="false">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="758" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 757;"><span id="cb23-758"><a href="#cb23-758" aria-hidden="true" tabindex="-1"></a>chart2 <span class="op">=</span> <span class="fu">Treemap</span>(subset<span class="op">,</span> {</span>
<span id="cb23-759"><a href="#cb23-759" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">?.</span><span class="at">mail</span><span class="op">,</span> <span class="co">// size of each node (file); null for internal nodes (folders)</span></span>
<span id="cb23-760"><a href="#cb23-760" aria-hidden="true" tabindex="-1"></a>  <span class="dt">path</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span> <span class="op">+</span> <span class="st">"/"</span> <span class="op">+</span> d<span class="op">.</span><span class="at">source</span><span class="op">,</span> <span class="co">// e.g., "flare/animate/Easing"</span></span>
<span id="cb23-761"><a href="#cb23-761" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span><span class="op">,</span> <span class="co">// e.g., "animate" in "flare.animate.Easing"; for color</span></span>
<span id="cb23-762"><a href="#cb23-762" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">domain</span> <span class="op">+</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span></span>
<span id="cb23-763"><a href="#cb23-763" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">domain</span><span class="sc">}\n${</span>d<span class="op">.</span><span class="at">mail</span><span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="co">// text to show on hover</span></span>
<span id="cb23-764"><a href="#cb23-764" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">1152</span><span class="op">,</span></span>
<span id="cb23-765"><a href="#cb23-765" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">1152</span></span>
<span id="cb23-766"><a href="#cb23-766" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" data-startfrom="771" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 770;"><span id="cb24-771"><a href="#cb24-771" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb24-772"><a href="#cb24-772" aria-hidden="true" tabindex="-1"></a><span class="vs">.slidecontainer {</span></span>
<span id="cb24-773"><a href="#cb24-773" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb24-774"><a href="#cb24-774" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb24-775"><a href="#cb24-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-776"><a href="#cb24-776" aria-hidden="true" tabindex="-1"></a><span class="vs">.slider {</span></span>
<span id="cb24-777"><a href="#cb24-777" aria-hidden="true" tabindex="-1"></a><span class="vs">  -webkit-appearance: none;</span></span>
<span id="cb24-778"><a href="#cb24-778" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb24-779"><a href="#cb24-779" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 15px;</span></span>
<span id="cb24-780"><a href="#cb24-780" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 5px;</span></span>
<span id="cb24-781"><a href="#cb24-781" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #d3d3d3;</span></span>
<span id="cb24-782"><a href="#cb24-782" aria-hidden="true" tabindex="-1"></a><span class="vs">  outline: none;</span></span>
<span id="cb24-783"><a href="#cb24-783" aria-hidden="true" tabindex="-1"></a><span class="vs">  opacity: 0.7;</span></span>
<span id="cb24-784"><a href="#cb24-784" aria-hidden="true" tabindex="-1"></a><span class="vs">  -webkit-transition: .2s;</span></span>
<span id="cb24-785"><a href="#cb24-785" aria-hidden="true" tabindex="-1"></a><span class="vs">  transition: opacity .2s;</span></span>
<span id="cb24-786"><a href="#cb24-786" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb24-787"><a href="#cb24-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-788"><a href="#cb24-788" aria-hidden="true" tabindex="-1"></a><span class="vs">.slider:hover {</span></span>
<span id="cb24-789"><a href="#cb24-789" aria-hidden="true" tabindex="-1"></a><span class="vs">  opacity: 1;</span></span>
<span id="cb24-790"><a href="#cb24-790" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb24-791"><a href="#cb24-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-792"><a href="#cb24-792" aria-hidden="true" tabindex="-1"></a><span class="vs">.slider::-webkit-slider-thumb {</span></span>
<span id="cb24-793"><a href="#cb24-793" aria-hidden="true" tabindex="-1"></a><span class="vs">  -webkit-appearance: none;</span></span>
<span id="cb24-794"><a href="#cb24-794" aria-hidden="true" tabindex="-1"></a><span class="vs">  appearance: none;</span></span>
<span id="cb24-795"><a href="#cb24-795" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 25px;</span></span>
<span id="cb24-796"><a href="#cb24-796" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 25px;</span></span>
<span id="cb24-797"><a href="#cb24-797" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 50%;</span></span>
<span id="cb24-798"><a href="#cb24-798" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #4CAF50;</span></span>
<span id="cb24-799"><a href="#cb24-799" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: pointer;</span></span>
<span id="cb24-800"><a href="#cb24-800" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb24-801"><a href="#cb24-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-802"><a href="#cb24-802" aria-hidden="true" tabindex="-1"></a><span class="vs">.slider::-moz-range-thumb {</span></span>
<span id="cb24-803"><a href="#cb24-803" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 25px;</span></span>
<span id="cb24-804"><a href="#cb24-804" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 25px;</span></span>
<span id="cb24-805"><a href="#cb24-805" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 50%;</span></span>
<span id="cb24-806"><a href="#cb24-806" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #4CAF50;</span></span>
<span id="cb24-807"><a href="#cb24-807" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: pointer;</span></span>
<span id="cb24-808"><a href="#cb24-808" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb24-809"><a href="#cb24-809" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-23" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" data-startfrom="815" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 814;"><span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {disposal} <span class="im">from</span> <span class="st">"@mbostock/disposal"</span></span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(</span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a>  values<span class="op">,</span></span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a>    initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a>    delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a>    autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a>    loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a>    alternate <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> {}</span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="margin-right: 0.4em; width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span></span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 class="slider" style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;"&gt;</span></span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="margin-left: 0.4em;"&gt;&lt;/output&gt;</span></span>
<span id="cb25-835"><a href="#cb25-835" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb25-836"><a href="#cb25-836" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb25-837"><a href="#cb25-837" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-838"><a href="#cb25-838" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> direction <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb25-839"><a href="#cb25-839" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb25-840"><a href="#cb25-840" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb25-841"><a href="#cb25-841" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span></span>
<span id="cb25-842"><a href="#cb25-842" aria-hidden="true" tabindex="-1"></a>      delay <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">requestAnimationFrame</span>(tick) <span class="op">:</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb25-843"><a href="#cb25-843" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-844"><a href="#cb25-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-845"><a href="#cb25-845" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb25-846"><a href="#cb25-846" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb25-847"><a href="#cb25-847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(timer)<span class="op">;</span></span>
<span id="cb25-848"><a href="#cb25-848" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="cb25-849"><a href="#cb25-849" aria-hidden="true" tabindex="-1"></a>    timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-850"><a href="#cb25-850" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-851"><a href="#cb25-851" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb25-852"><a href="#cb25-852" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) timer <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb25-853"><a href="#cb25-853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb25-854"><a href="#cb25-854" aria-hidden="true" tabindex="-1"></a>      form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span></span>
<span id="cb25-855"><a href="#cb25-855" aria-hidden="true" tabindex="-1"></a>      (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)</span>
<span id="cb25-856"><a href="#cb25-856" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb25-857"><a href="#cb25-857" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb25-858"><a href="#cb25-858" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb25-859"><a href="#cb25-859" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-860"><a href="#cb25-860" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span></span>
<span id="cb25-861"><a href="#cb25-861" aria-hidden="true" tabindex="-1"></a>      (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb25-862"><a href="#cb25-862" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb25-863"><a href="#cb25-863" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-864"><a href="#cb25-864" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb25-865"><a href="#cb25-865" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> timer) form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="fu">onclick</span>()<span class="op">;</span></span>
<span id="cb25-866"><a href="#cb25-866" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb25-867"><a href="#cb25-867" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb25-868"><a href="#cb25-868" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-869"><a href="#cb25-869" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb25-870"><a href="#cb25-870" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb25-871"><a href="#cb25-871" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span></span>
<span id="cb25-872"><a href="#cb25-872" aria-hidden="true" tabindex="-1"></a>      alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb25-873"><a href="#cb25-873" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb25-874"><a href="#cb25-874" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb25-875"><a href="#cb25-875" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb25-876"><a href="#cb25-876" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-877"><a href="#cb25-877" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb25-878"><a href="#cb25-878" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb25-879"><a href="#cb25-879" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb25-880"><a href="#cb25-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb25-881"><a href="#cb25-881" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb25-882"><a href="#cb25-882" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"\nparseDate = d3.utcParse(\"%Y-%m-%d\");\nstartDate = parseDate(\"2022-06-30\");\nendDate = parseDate(\"2022-09-05\");\ndaysBetween = d3.utcDay.count(startDate, endDate);\nmiddleDate = d3.utcDay.offset(startDate, Math.floor(daysBetween / 2));\n\n// Line for network\naddTooltips(\nPlot.plot({\n  y: {\n    grid: true,\n    label: \"↑ Nombre d'inscrits à la liste de diffusion\"\n  },\n  marks: [\n    Plot.line(serie_contacts, {\n        x: \"date\", y: \"mail\",\n        stroke: \"#6886bb\"\n        //marker: \"circle\",\n        //curve: \"step\", strokeWidth: 1\n        }),        \n    Plot.dot(serie_contacts, {\n        x: \"date\", y: \"mail\",\n        title: (d) => `${new Date(d.date).toLocaleDateString(\"en-US\", {\n                timeZone: \"UTC\"\n              })} \\n ${d.mail} inscrits `,\n        fill: \"#6886bb\"\n        //marker: \"circle\",\n        //curve: \"step\", strokeWidth: 1\n        }),\n    // vertical rule to mark date/time of event\n    Plot.ruleX([d3.utcParse(\"%Y-%m-%d\")(\"2022-06-30\"), d3.utcParse(\"%Y-%m-%d\")(\"2022-09-05\")], {\n        stroke: \"gray\", strokeWidth: 2, strokeDasharray: \"4 2\"\n        }),\n    Plot.text([[0]], {\n      text: [\"Réseau en pause pendant \\n les vacances d'été 🌞\"],\n      x: middleDate,\n      y: 290,\n      textAnchor: \"center\"\n      //fill: \"#6886bb\"\n    }),\n    width > 500\n    ? Plot.text(annotations, {\n          x: \"date\",\n          y: \"textCount\",\n          lineHeight: 1.3,\n          width: 20,\n        text: (d) =>\n            `${new Date(d.date).toLocaleDateString(\"en-US\", {\n                timeZone: \"UTC\"\n              })} \\n ${d.text} `,\n          textAnchor: \"start\"\n        })\n    : [\n        Plot.text(annotations, {\n            x: \"date\",\n            y: \"textCount\",\n            lineHeight: 1.3,\n            width: 20,\n            fill: \"#6886bb\",\n            text: (d, i) => i + 1,\n            textAnchor: \"center\"\n          }),\n          Plot.dot(annotations, {\n            x: \"date\",\n            y: \"textCount\",\n            r: 10\n          })\n    ],\n    Plot.arrow(annotations, {\n      x2: \"date\",\n      y1: \"textCount\",\n      x1: \"endDate\",\n      y2: \"endCount\",\n      // dx: 14,\n      bend: 20,\n      inset: 5,\n      head: null,\n      strokeOpacity: 0.5\n    })    \n    ],\n  marginLeft: 50,\n  width: 900,\n  height: 500, \n  caption:\n    width > 500\n      ? \"\"\n      : html`<details><summary>Dérouler la <i>timeline</i> du réseau</summary>${annotations\n          .map(\n            (d, i) =>\n              `(${i + 1}) ${new Date(d.date).toLocaleDateString(\"en-US\", {\n                timeZone: \"UTC\"\n              })} – ${d.text} `\n          )\n          .join(\"<br>\")}</details>`\n}),\n    {\n        fill: \"red\",\n        stroke: \"blue\",\n        r: 8\n    }\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof input_date = Scrubber(\n  serie_contacts_domain.map(d => d.date), {\n  delay: 50,\n  autoplay: false,\n  unique: true,\n  sort: true,\n  format: date => date.toLocaleString(\"en\", {month: \"long\", day: \"numeric\"})\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"// Source: https://observablehq.com/@mbostock/dashboard\ngrid = html`<div style=\"\n  background: #fff;\n  margin: 0;\n  border: none ;\n  display: grid;\n  width: ${screen.width};\n  grid-template-areas: \n    'a b'\n    'a b'\n    'a b'\n    'c c';\n  grid-gap: 10px;\n\">\n  <div name=\"a\" style=\"grid-area: a; position: relative;\">${plt2}</div>\n  <div name=\"b\" style=\"grid-area: b; position: relative;\">${plt1}</div>\n  <div name=\"c\" style=\"grid-area: c; position: relative;\">${plt3}</div>\n</div>`\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"\n// Line for network\nplt1 = addTooltips(\n    Plot.plot({\n    y: {\n        domain: [110,320],\n        grid: true,\n        label: \"↑ Nombre d'inscrits à la liste de diffusion\"\n    },\n    marks: [\n        Plot.dot(serie_contacts,\n            {\n                x: \"date\", y: \"mail\",\n                fill: \"#6886bb\",\n                title: (d) => `${new Date(d.date).toLocaleDateString(\"en-US\", {\n                    timeZone: \"UTC\"\n                })} \\n ${d.mail} inscrits `\n                //marker: \"circle\",\n                //curve: \"step\", strokeWidth: 1\n            }),   \n        Plot.line(serie_contacts,\n            {\n                x: \"date\", y: \"mail\",\n                stroke: \"#6886bb\"\n                //marker: \"circle\",\n                //curve: \"step\", strokeWidth: 1\n            }),   \n        Plot.dot(serie_contacts.filter(d => dateFormat(d.date) <= dateFormat(input_date)),\n            {\n                x: \"date\", y: \"mail\",\n                fill: \"red\",\n                title: (d) => `${new Date(d.date).toLocaleDateString(\"en-US\", {\n                                timeZone: \"UTC\"\n                            })} \\n ${d.mail} inscrits `            \n                //marker: \"circle\",\n                //curve: \"step\", strokeWidth: 1\n            }), \n        Plot.line(serie_contacts.filter(d => dateFormat(d.date) <= dateFormat(input_date)),\n            {\n                x: \"date\", y: \"mail\",\n                stroke: \"red\"\n                //marker: \"circle\",\n                //curve: \"step\", strokeWidth: 1\n            }),   \n        Plot.arrow(annotations.filter(d => dateFormat(d.date) == dateFormat(input_date)), {\n        x2: \"date\",\n        y1: \"textCount\",\n        x1: \"endDate\",\n        y2: \"endCount\",\n        // dx: 14,\n        bend: 20,\n        inset: 5,\n        head: null,\n        strokeOpacity: 0.5\n        }),\n        Plot.text(annotations.filter(d => dateFormat(d.date) == dateFormat(input_date)), {\n                    x: \"date\",\n                    y: \"textCount\",\n                    lineHeight: 1.3,\n                    width: 20,\n                    text: (d) =>\n                        `${new Date(d.date).toLocaleDateString(\"en-US\", {\n                            timeZone: \"UTC\"\n                        })} \\n ${d.text} `,\n                    textAnchor: \"start\"\n                })        \n        ],\n    marginLeft: 50,\n    width: 500,\n    height: 300, \n    }),\n    {\n        fill: \"green\",\n        stroke: \"black\",\n        r: 8\n    }\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"dateFormat = d3.utcFormat(\"%Y-%m-%d\")\nsubset = serie_contacts_domain.filter(d => dateFormat(d.date) == dateFormat(input_date))\norder_domain = d3.groupSort(\n  serie_contacts_domain,\n  (g) => d3.max(g, (d) => d.mail),\n  (d) => d.domain\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"array1 = ssp.concat(autres_ssp)\narray2 = subset.map(d => d.domain)\nhors_ssp_all = serie_contacts_domain.map(d => d.domain).filter(d => !array1.includes(d))\nhors_ssp = [... new Set(hors_ssp_all)]\ncolors_hors_ssp = Array(hors_ssp.length).fill(\"#fb9a99\")\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"ssp = [\n    'INSEE', 'Santé', 'Développement Durable', 'Agriculture', 'Finances', 'Travail', 'Intérieur', 'Recherche'\n    ]\nautres_ssp = ['Justice', 'Culture', \"Collectivités Locales\", \"Enseignement Supérieur\",\n                \"Jeunesse Sports\", \"Défense\"]\ncolors_autres_ssp = Array(6).fill(\"orange\")\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"plt2 = addTooltips(\n    Plot.plot({\n    width: 500,\n    paddingTop: 80,\n    projection: {\n        // equal-area is crucial to maintain comparability of the slices,\n        // but it could be any other equal-area projection\n        type: \"azimuthal-equal-area\", \n        rotate: [0, 180 - 90]\n    },\n    color: {\n        type: \"categorical\",\n        legend: false, \n        label: \"Institution\",\n        domain: ssp.concat(autres_ssp).concat(hors_ssp), \n        range: [\n            \"#5a5758\", \"#9cb5b8\", \"forestgreen\", \"#e8d630\", \"gold\", \"#2d378c\", \"brown\", \"lavender\"\n            ].concat(colors_autres_ssp).concat(colors_hors_ssp)\n    },\n    sort: {\n            color: \"stroke\",\n            reduce: \"count\",\n            reverse: true,\n            domain: ssp.concat(autres_ssp).concat(hors_ssp)\n            },    \n    marks: [\n        pie(\n            subset, {\n                value: \"mail\", fill: \"domain\",\n                title: d => `${d.domain}: ${d.mail} \\n (${(d.mail / d3.sum(subset, d => d.mail)).toLocaleString(undefined, {style: \"percent\"})} du total)` \n                })        \n    ]\n    }),\n    { fill: \"gray\", opacity: 0.5, \"stroke-width\": \"3px\", stroke: \"red\" } \n)\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"plt3 = addTooltips(\n    Plot.plot({\n        y: {\n            label: \"Institution\"\n        },\n        x: {\n            label: \"Nombre d'inscrits à la liste de diffusion →\"\n        },\n        marginLeft: 150,\n        color: {\n            type: \"categorical\",\n            legend: false, \n            label: \"Institution\",\n            domain: ssp.concat(autres_ssp).concat(hors_ssp), \n            range: [\n                \"#5a5758\", \"#9cb5b8\", \"forestgreen\", \"#e8d630\", \"gold\", \"#2d378c\", \"brown\", \"lavender\"\n                ].concat(colors_autres_ssp).concat(colors_hors_ssp),\n        },\n    marks: [\n        Plot.barX(\n            subset,\n            {\n                x: \"mail\", y: \"domain\", fill: \"domain\", sort: {y: \"x\", reverse: true},\n                title: d => `${d.domain}: ${d.mail} \\n (${(d.mail / d3.sum(subset, d => d.mail)).toLocaleString(undefined, {style: \"percent\"})} du total)`,\n            }),\n        Plot.ruleX([0]),\n        Plot.text(subset,\n        {\n            x: \"mail\", y: \"domain\", dx: 5,\n            text: d => `${d.mail} (${(d.mail / d3.sum(subset, d => d.mail)).toLocaleString(undefined, {style: \"percent\"})})`,\n            textAnchor: \"start\"\n        })      \n    ]\n    }),\n    { fill: \"gray\", opacity: 0.5, \"stroke-width\": \"3px\", stroke: \"red\" } \n)\n\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"stats_tchap_vs_outlook = db.sql`\nSELECT source, domain, CAST(COUNT(*) AS int) AS count\nFROM latest\nWHERE domain IN (SELECT domain\n                FROM latest\n                GROUP BY domain\n                HAVING COUNT(*) > 10)\nGROUP BY source, domain\n`\n\nstats_all = db.sql`\nSELECT source, domain, CAST(COUNT(*) AS int) AS count\nFROM latest\nGROUP BY source, domain\n`\n//viewof tt = Inputs.table(stats_all)\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"addTooltips(\n    Plot.plot({\n    x: {\n        domain: order_domain_all,\n        label: \"Institution\"\n    },        \n    y: {\n        grid: true,\n        label: \"↑ Nombre d'inscrits\"\n        },\n    color: {\n        legend: true,\n        type: \"categorical\",\n        scheme: \"pastel1\",\n        domain: [\"Diffusion mail et Tchap\", \"Diffusion mail\", \"Tchap\"] // setting the order manually by specifying the array\n    },\n    marks: [\n        Plot.barY(stats_tchap_vs_outlook,\n        {\n            x: \"domain\", y: \"count\", sort: \"source\", fill: \"source\",\n            title: d => `${d.source}: ${d.count} \\n (${(d.count / d3.sum(stats_tchap_vs_outlook.filter(t => t.domain == d.domain), d => d.count)).toLocaleString(undefined, {style: \"percent\"})})` \n        }),\n        Plot.ruleY([0])\n    ],\n    style: { paddingTop: 50},\n    caption: html`<details><summary>Dérouler la note:</summary><i>Seules les institutions comportant au moins 10 inscrits sont présentées dans ce graphique</i></details>`\n    }),\n  // Set styles for the hovered element\n  { fill: \"gray\", opacity: 0.5, \"stroke-width\": \"3px\", stroke: \"red\" }    \n)\n"},{"methodName":"interpret","cellName":"ojs-cell-12","inline":false,"source":"order_domain_all = d3.groupSort(\n  stats_tchap_vs_outlook,\n  (g) => d3.sum(g, (d) => -d.count),\n  (d) => d.domain\n)\n//viewof tt = Inputs.table(stats_tchap_vs_outlook)\n"},{"methodName":"interpret","cellName":"ojs-cell-13","inline":false,"source":"annotations = [\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-02-22\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-02-22\"),\n    endCount: 112,\n    text: \"Newsletter n°1 🎉\",\n    textDate: \"2022-02-23\",\n    textCount: 250,\n    bend: 20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-03-17\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-03-17\"),\n    endCount: 153,\n    text: \"Newsletter n°2\",\n    textDate: \"2022-02-23\",\n    textCount: 230,\n    bend: -5\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-04-22\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-04-22\"),\n    endCount: 188,\n    text: \"Newsletter n°3\",\n    textDate: \"2022-04-14\",\n    textCount: 140,\n    bend: 20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-05-14\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-05-14\"),\n    endCount: 212,\n    text: \"Newsletter n°4\",\n    textDate: \"2022-05-23\",\n    textCount: 180,\n    bend: 20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-06-14\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-06-17\"),\n    endCount: 227,\n    text: \"Newsletter n°5\",\n    textDate: \"2022-06-15\",\n    textCount: 160,\n    bend: -20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-10-26\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-10-26\"),\n    endCount: 261,\n    text: \"Newsletter n°6\",\n    textDate: \"2022-10-26\",\n    textCount: 295,\n    bend: -20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-11-30\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-11-30\"),\n    endCount: 282,\n    text: \"Newsletter n°7\",\n    textDate: \"2022-11-30\",\n    textCount: 230,\n    bend: -20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-04-22\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-04-22\"),\n    endCount: 188,\n    text: \"OpenHour n°1\",\n    textDate: \"2022-04-22\",\n    textCount: 240,\n    bend: -20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-06-03\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-06-03\"),\n    endCount: 220,\n    text: \"OpenHour n°2\",\n    textDate: \"2022-06-03\",\n    textCount: 270,\n    bend: -20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-09-13\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-09-13\"),\n    endCount: 232,\n    text: \"Nouvelle version du site web\",\n    textDate: \"2022-09-13\",\n    textCount: 150\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-09-30\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-09-30\"),\n    endCount: 245,\n    text: \"Premier post de blog\",\n    textDate: \"2022-09-30\",\n    textCount: 205,\n    bend: 20\n  },\n  {\n    date: d3.utcParse(\"%Y-%m-%d\")(\"2022-11-16\"),\n    endDate: d3.utcParse(\"%Y-%m-%d\")(\"2022-11-16\"),\n    endCount: 275,\n    text: `Présentation observable\\npar Nicolas Lambert`,\n    textDate: \"2022-09-13\",\n    textCount: 150,\n    bend: 20\n  },\n]\n"},{"methodName":"interpret","cellName":"ojs-cell-15","inline":false,"source":"configuredClient = {\n  const client = await DuckDBClient.of();\n  await client.sql`\n    SET s3_endpoint='minio.lab.sspcloud.fr'\n  `;\n  return client;\n}\nurl_latest = 's3://lgaliana/ssphub/files/retrospective2022-observable/list_contacts_latest.parquet'\nurl_latest2 = 's3://lgaliana/ssphub/files/retrospective2022-observable/series_nombre_contact.parquet'\ndb = {\n  await configuredClient.query(`\n    CREATE VIEW latest AS \n    SELECT * FROM read_parquet('${url_latest}') ;\n  `);\n  await configuredClient.query(`\n    CREATE VIEW serie AS \n    SELECT * FROM read_parquet('${url_latest2}') ;\n  `);\n  return configuredClient\n}\n\n//db = DuckDBClient.of({\n//  latest: await FileAttachment(\"list_contacts_latest.csv\").csv({typed: true}),\n//  serie: await FileAttachment(\"series_nombre_contact.csv\").csv({typed: true})\n//})\n"},{"methodName":"interpret","cellName":"ojs-cell-17","inline":false,"source":"serie_contacts = db.sql`\nSELECT date, CAST(SUM(mail) AS int) AS mail\nFROM serie\nGROUP BY date\n`\nserie_contacts_domain = db.sql`\nSELECT date, domain, CAST(mail AS int) AS mail\nFROM serie\n`\n\n//viewof tt3 = Inputs.table(serie_contacts_domain)\n//SummaryTable(serie_contacts_domain)\n"},{"methodName":"interpret","cellName":"ojs-cell-18","inline":false,"source":"//import {Plot} from \"@mkfreeman/plot-tooltip\"\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\nimport {SummaryTable} from \"@observablehq/summary-table\"\nimport {Treemap} from \"@d3/treemap\"\nimport { style as faStyle, fa, fas } from \"@airbornemint/fontawesome\"\nfaStyle({regular: true, solid: true, brands: true})\nPlot = require('@observablehq/plot@0.6.1/dist/plot.umd.min.js')\n"},{"methodName":"interpret","cellName":"ojs-cell-19","inline":false,"source":"\n// Borrowed to https://observablehq.com/@observablehq/whats-different-timeseries-forecast-performance?collection=@observablehq/analyzing-time-series-data\ncolors = new Map([\n  [\"Infolettre\", \"#6886bb\"], \n  [\"Event\", \"#a2a5ba\"]\n])\n"},{"methodName":"interpret","cellName":"ojs-cell-20","inline":false,"source":"pie = (data, { value, ...options }) => {\n  const cs = d3.cumsum(data, (d) => d[value]);\n  const r = 360 / cs[cs.length - 1];\n  for (let i = 0; i < cs.length; ++i) cs[i] *= r;\n  for (const d of data)\n    return Plot.geo(\n      {\n        type: \"GeometryCollection\",\n        geometries: data.map((d, i) => {\n          const a = -(cs[i - 1] || 0);\n          const b = -cs[i];\n          return {\n            type: \"Polygon\",\n            ...d,\n            coordinates: [\n              [\n                [0, 90],\n                [a, 0],\n                [(2 * a + b) / 3, 0], // add intermediate points for sectors larger than a half-circle\n                [(a + 2 * b) / 3, 0],\n                [b, 0],\n                [0, 90]\n              ]\n            ]\n          };\n        })\n      },\n      { ...options }\n    );\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-21","inline":false,"source":"//addTooltips(\n    Treemap(stats_all, {\n    value: d => d?.count, // size of each node (file); null for internal nodes (folders)\n    path: d => d.domain + \"/\" + d.source, // e.g., \"flare/animate/Easing\"\n    group: d => d.domain, // e.g., \"animate\" in \"flare.animate.Easing\"; for color\n    label: d => `${d.domain}\\n${d.source}\\n${d.count.toLocaleString()}`,\n    //title: d => `${d.domain}\\n${d.count.toLocaleString()}\\n`, // text to show on \n    title: d => `${d.domain}\\n${d.source}\\n${d.count} \\n(${(d.count / d3.sum(stats_all.filter(t => t.domain == d.domain), d => d.count)).toLocaleString(undefined, {style: \"percent\"})} des inscrits ${d.domain})`,\n    width: 1152,\n    height: 1152,\n    tile: d3.treemapSquarify,\n    colors: [\"#5a5758\", \"#9cb5b8\", \"forestgreen\", \"#e8d630\", \"gold\", \"#2d378c\", \"brown\", \"lavender\"].concat(colors_autres_ssp).concat(colors_hors_ssp), // array of colors\n    zDomain: ssp.concat(autres_ssp).concat(hors_ssp), // array of values for the color scale\n    stroke: d => d.domain\n    })//,\n    //{ fill: \"gray\", opacity: 0.5, \"stroke-width\": \"3px\", stroke: \"red\" }    \n//)\n"},{"methodName":"interpret","cellName":"ojs-cell-23","inline":false,"source":"html`<style>\n.slidecontainer {\n  width: 100%;\n}\n\n.slider {\n  -webkit-appearance: none;\n  width: 100%;\n  height: 15px;\n  border-radius: 5px;\n  background: #d3d3d3;\n  outline: none;\n  opacity: 0.7;\n  -webkit-transition: .2s;\n  transition: opacity .2s;\n}\n\n.slider:hover {\n  opacity: 1;\n}\n\n.slider::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  width: 25px;\n  height: 25px;\n  border-radius: 50%;\n  background: #4CAF50;\n  cursor: pointer;\n}\n\n.slider::-moz-range-thumb {\n  width: 25px;\n  height: 25px;\n  border-radius: 50%;\n  background: #4CAF50;\n  cursor: pointer;\n}\n</style>`\n"},{"methodName":"interpret","cellName":"ojs-cell-24","inline":false,"source":"import {disposal} from \"@mbostock/disposal\"\nfunction Scrubber(\n  values,\n  {\n    format = value => value,\n    initial = 0,\n    delay = null,\n    autoplay = true,\n    loop = true,\n    alternate = false,\n    width = 500\n  } = {}\n) {\n  values = Array.from(values);\n  const form = html`<form style=\"font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;\">\n  <button name=b type=button style=\"margin-right: 0.4em; width: 5em;\"></button>\n  <label style=\"display: flex; align-items: center;\">\n    <input name=i type=range min=0 max=${values.length -\n      1} value=${initial} step=1 class=\"slider\" style=\"width: ${width}px;\">\n    <output name=o style=\"margin-left: 0.4em;\"></output>\n  </label>\n</form>`;\n  let timer = null;\n  let direction = 1;\n  function start() {\n    form.b.textContent = \"Pause\";\n    timer =\n      delay === null ? requestAnimationFrame(tick) : setInterval(tick, delay);\n  }\n\n  function stop() {\n    form.b.textContent = \"Play\";\n    if (delay === null) cancelAnimationFrame(timer);\n    else clearInterval(timer);\n    timer = null;\n  }\n  function tick() {\n    if (delay === null) timer = requestAnimationFrame(tick);\n    if (\n      form.i.valueAsNumber ===\n      (direction > 0 ? values.length - 1 : direction < 0 ? 0 : NaN)\n    ) {\n      if (!loop) return stop();\n      if (alternate) direction = -direction;\n    }\n    form.i.valueAsNumber =\n      (form.i.valueAsNumber + direction + values.length) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n  }\n  form.i.oninput = event => {\n    if (event && event.isTrusted && timer) form.b.onclick();\n    form.value = values[form.i.valueAsNumber];\n    form.o.value = format(form.value, form.i.valueAsNumber, values);\n  };\n  form.b.onclick = () => {\n    if (timer) return stop();\n    direction =\n      alternate && form.i.valueAsNumber === values.length - 1 ? -1 : 1;\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    start();\n  };\n  form.i.oninput();\n  if (autoplay) start();\n  else stop();\n  disposal(form).then(stop);\n  return form;\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('input_date')"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>